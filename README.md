# copy

ファイルをコピーするプログラム copy を作成しなさい．
雛形として`main.c`が与えられます．この`main.c`を元に，与えられたそれぞれのステップに取り組んでください．
それぞれのステップを適切に実装できれば，その都度GitHubに変更を push してください．

1. コマンドライン引数に2つのファイル名が与えられます．第１引数で与えられたのファイルの内容を第２引数で与えられたファイルにコピーしなさい．
2. 入力ファイル名が `-` であった場合は標準入力から受け取り，出力ファイル名が `-` であった場合，標準出力に出力するようにしなさい．
3. コマンドライン引数にn個のファイルが与えられ，コマンドライン引数の最後にディレクトリ名が指定された場合，n個のファイルを全て最後のディレクトリにコピーしなさい．

## ステップ1

コマンドライン引数に2つのファイル名が与えられます．
第１引数で与えられたのファイルの内容を第２引数で与えられたファイルにコピーしなさい．

### 入出力例

```sh
./copy main.c copied.c # <- main.c の内容を copied.c にコピーする．
diff main.c copied.c   # <- 同じファイルになるため，何も出力しない．
```

### 修正方針

次の修正を行ってください．

* 14行目にファイルを読み込み専用で開く処理（`fopen`）を追加しましょう．
* 19行目にファイルを書き込み専用で開く処理（`fopen`）を追加しましょう．
* 10行目の`copy_impl`関数の中身を書きましょう．
     * `from`から1文字読み（`fgetc`），`to`に書き込み（`fputc`）ましょう．


## ステップ2

ステップ1の結果を元に，次の処理を追加してください．
入力ファイル名が `-` であった場合は標準入力から受け取り，出力ファイル名が `-` であった場合，標準出力に出力するようにしなさい．

### 入出力例

```sh
cat main.c | ./copy - dest.c      # <- 標準入力からの内容（main.c）をdest.cにコピーする．
diff main.c dest.c                # <- 同じファイルになるため，何も出力しない．
./copy main.c - > dest2.c         # <- main.c の内容を標準出力（dest2.c）にコピーする．
diff main.c dest2.c               # <- 同じファイルになるため，何も出力しない．
cat main.c | ./copy - - > dest3.c # copy main.c dest3.c と同様．
diff main.c dest3.c               # <- 同じファイルになるため，何も出力しない．
```

### 修正方針

次の修正を行ってください．

* `fopen`を`open_impl`関数に置き換えましょう．
    * `open_impl`関数はファイル名（`file_name`），モード（`mode`），`FILE`型のデフォルトのファイルポインタ（`defaultFP`）を受け取ります．
    * もし，`file_name`が`"-"`と一致すれば，`defaultFP`を返しましょう．
    * そうでなければ，`fopen`でファイルを開きましょう．

## ステップ3

ステップ2の結果を元に，次の処理を追加してください．
コマンドライン引数にn個のファイルが与えられ，コマンドライン引数の最後にディレクトリ名が指定された場合，n個のファイルを全て最後のディレクトリにコピーしなさい．

### 入出力例

```sh
mkdir dest_dir                      # <- dest_dir ディレクトリを作成する．
./copy main.c README.md dest_dir    # <- main.c, README.md を dest_dir にコピーする．
ls dest_dir
README.md      main.c
./copy main.c README.md missing_dir # <- missing_dirが存在しないので，失敗する．
missing_dir: directory not found.
./copy main.c README.md copy        # <- 最後のファイル（copy）がディレクトリではないので失敗する．
copy: not directory.
```

### 修正方針

次の修正を行ってください．

* `perform`メソッドの`if`文の後ろに`argc > 3`の条件を追加しましょう．
    * その条件が合致する場合は，`copyN(argc, argv)`を呼び出しましょう．
* `int copyN(int argc, char *argv[])` 関数を作成しましょう．
    * `argv`の`1`から`argc - 1`までの間，各`argv[i]`について，以下の処理を行いましょう．
        * `sprintf`関数を使い，出力先のファイルパスを作成しましょう．
            * `sprintf(dest, "%s/%s", argv[argc - 1], argv[i])`
            * `dest`は`char`型の配列で，長さは`256`程度で良いでしょう．
        * `copy(argv[i], dest)`関数を呼び出しましょう．
            * `copy`関数の返り値が`0`でなければ`perror(argv[i])`でエラーを表示し，`copyN`関数からreturnしましょう．
    * 最後の，正常終了を表すステータスコード `0` をreturnしましょう．
